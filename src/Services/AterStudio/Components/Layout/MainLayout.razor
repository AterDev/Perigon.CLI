@inherits LayoutComponentBase
@inject Localizer Localizer
@inject IJSRuntime JS
<FluentLayout>
    <FluentHeader Class="header" Height="56" Style="background:var(--neutral-layer-2)">
        <ChildContent>
            <FluentStack>
                <FluentNavLink Href="/">
                    <FluentLabel Typo="Typography.H5">
                        Ater Studio
                    </FluentLabel>
                </FluentNavLink>
            </FluentStack>
            <FluentSpacer />
            <FluentStack Orientation="Orientation.Horizontal" VerticalAlignment="VerticalAlignment.Center"
                         HorizontalAlignment="HorizontalAlignment.Center">
                <FluentNavLink Href="/">
                    <FluentButton Appearance="Appearance.Neutral"
                                  BackgroundColor="rgba(0, 0, 0, 0)">
                        @Localizer.Get(Localizer.Solution)
                    </FluentButton>
                </FluentNavLink>
                <FluentNavLink Href="/tools">
                    <FluentButton Appearance="Appearance.Neutral"
                                  BackgroundColor="rgba(0, 0, 0, 0)">
                        @Localizer.Get(Localizer.Tools)
                    </FluentButton>
                </FluentNavLink>

            </FluentStack>
            <FluentSpacer />
            <FluentStack Orientation="Orientation.Horizontal"
                         VerticalAlignment="VerticalAlignment.Center"
                         HorizontalAlignment="HorizontalAlignment.End">

                <FluentIcon Value="@(new Icons.Regular.Size24.DocumentOnePageSparkle())" Color="Color.Neutral" />
                <a href="https://github.com/AterDev/ater.dry.cli">
                    @if (isDarkMode)
                    {
                        <img src="assets/github-mark-white.svg" width="20" alt="github" />
                    }
                    else
                    {
                        <img src="assets/github-mark.svg" width="20" alt="github" />
                    }

                </a>
            </FluentStack>
        </ChildContent>


    </FluentHeader>
    <FluentStack Class="main" Orientation="Orientation.Horizontal" Width="100%">
        <FluentBodyContent Class="main-content">
            <div class="main-body-content">
                <FluentMessageBarProvider Section="MESSAGES_TOP" />
                @Body
            </div>
        </FluentBodyContent>
    </FluentStack>
</FluentLayout>

<FluentToastProvider />
<FluentDialogProvider />
<FluentTooltipProvider />
<FluentMessageBarProvider />
<FluentMenuProvider />


<div id="blazor-error-ui" data-nosnippet>
    An unhandled error has occurred.
    <a href="." class="reload">Reload</a>
    <span class="dismiss">üóô</span>
</div>

<FluentDesignTheme @bind-Mode="@Mode" StorageName="theme" />
@code
{
    public DesignThemeModes Mode { get; set; } = DesignThemeModes.System;
    private bool isDarkMode = false;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {

        var themeMode = await JS.InvokeAsync<string>("getCurrentThemeMode");
        StateHasChanged(); // Â¶ÇÊûúÈúÄË¶ÅÂà∑Êñ∞UI
        isDarkMode = themeMode == "dark";
    }
}