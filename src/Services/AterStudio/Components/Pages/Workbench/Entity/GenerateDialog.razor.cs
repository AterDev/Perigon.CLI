// <auto-generated />
using System.Collections;

using Microsoft.AspNetCore.Components;
using Microsoft.FluentUI.AspNetCore.Components;

namespace AterStudio.Components.Pages.Workbench.Entity;
public partial class GenerateDialog
{
    [CascadingParameter]
    FluentDialog Dialog { get; set; } = null!;

    [Parameter]
    public GenerateDialogData Content { get; set; } = default!;
    GenerateDto GenerateDto { get; set; } = default!;

    [Inject]
    EntityInfoManager EntityInfoManager { get; set; }

    [Inject]
    SolutionManager SolutionManager { get; set; } = default!;

    List<SubProjectInfo> Services { get; set; } = [];
    IEnumerable<SubProjectInfo> SelectedServices { get; set; } = [];
    string? SelectedValue;

    protected override Task OnInitializedAsync()
    {
        GenerateDto = new GenerateDto
        {
            EntityPath = string.Empty,
            CommandType = Content.CommandType,
            Force = false
        };
        GetServices();
        return base.OnInitializedAsync();
    }

    private void GetServices()
    {
        Services = SolutionManager.GetServices(true);
    }

    private async Task GenerateAsync()
    {
        if (Content.EntityPaths == null || Content.EntityPaths.Length == 0)
        {
            return;
        }
        GenerateDto.EntityPath = Content.EntityPaths[0];
        GenerateDto.CommandType = Content.CommandType;
        //await EntityInfoManager.GenerateAsync(GenerateDto);
        //await _dialog.HideAsync();
    }

    private async Task CancelAsync()
    {
        await Dialog.CancelAsync();
    }
}

public class GenerateDialogData
{
    public CommandType CommandType { get; set; }
    public string[] EntityPaths { get; set; } = [];
}